<!DOCTYPE html>
<html lang="es" xmlns="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head}">
    <title>Login - PocketBook</title>
</head>
<body class="d-flex flex-column min-vh-100">
  <!--CSS-->
  <link th:href="@{/css/login/imagencentral.css}" href="/css/login/imagencentral.css" rel="stylesheet">
  <link th:href="@{/css/login/form.css}" href="/css/login/form.css" rel="stylesheet">
  
    <!--NAVBAR-->
    <nav class="navbar navbar-light bg-primary">
  <div class="container-fluid d-flex justify-content-center align-items-center">
    <a class="navbar-brand d-flex align-items-center gap-2" href="#">
      <img th:src="@{/image/factura.png}" src="/image/factura.png" alt="PocketBook" width="30" height="24" class="d-inline-block align-text-top">
      <span class="text-white">PocketBook</span>
    </a>
  </div>
</nav>

<!--FORM-->
<main class="form-signin d-flex flex-column align-items-center flex-grow-1 image-central">
  
  <!-- MENSAJE DE ÉXITO DESDE REGISTRO -->
  <div th:if="${mensajeExito}" class="alert alert-success fade show" role="alert" style="width: 350px; margin-bottom: 1rem;">
    <i class="bi bi-check-circle-fill me-2"></i>
    <span th:text="${mensajeExito}"></span>
  </div>

  <!-- MENSAJE DE ERROR DE AUTENTICACIÓN -->
  <div th:if="${error}" class="alert alert-danger fade show" role="alert" style="width: 350px; margin-bottom: 1rem;">
    <i class="bi bi-exclamation-triangle-fill me-2"></i>
    <span th:text="${error}"></span>
  </div>

  <!-- MENSAJE DE LOGOUT -->
  <div th:if="${mensaje}" class="alert alert-info fade show" role="alert" style="width: 350px; margin-bottom: 1rem;">
    <i class="bi bi-info-circle-fill me-2"></i>
    <span th:text="${mensaje}"></span>
  </div>

  <form id="form" novalidate th:action="@{/login}" method="post" class="border border-dark rounded form-class p-4 shadow" style="width: 380px; background: rgba(255, 255, 255, 0.95);">
    <div class="text-center mb-4">
      <img class="mb-3" th:src="@{/image/login.png}" src="/image/login.png" alt="Login" width="72" height="72">
      <h1 class="h3 fw-bold">Bienvenido</h1>
      <p class="text-muted small mb-0">Inicia sesión en tu cuenta</p>
    </div>

    <div class="form-floating mb-3">
      <input type="email" name="username" class="form-control" id="inputEmail" placeholder="name@example.com" required>
      <label for="inputEmail"><i class="bi bi-envelope me-2"></i>Correo electrónico</label>
      <p id="emailError" class="emailError"></p>
    </div>
    
    <div class="form-floating mb-2 position-relative">
      <input type="password" name="password" class="form-control" id="inputPassword" placeholder="Password" required>
      <label for="inputPassword"><i class="bi bi-lock me-2"></i>Contraseña</label>
      <i class="bi bi-eye-slash position-absolute top-50 end-0 translate-middle-y me-3" id="togglePassword" style="cursor: pointer; z-index: 10; margin-top: -0.5rem;"></i>
      <p id="passError" class="passError"></p>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-4">
      <div class="form-check">
        <input type="checkbox" name="remember-me" class="form-check-input" id="rememberMe">
        <label class="form-check-label small" for="rememberMe">
          Recuérdame
        </label>
      </div>
      <a th:href="@{/recuperar-password}" href="/recuperar-password" class="text-primary text-decoration-none small">
        ¿Olvidaste tu contraseña?
      </a>
    </div>

    <button id="loginForm" class="w-100 btn btn-lg btn-primary mb-3 fw-semibold" type="submit">
      <i class="bi bi-box-arrow-in-right me-2"></i>Iniciar sesión
    </button>
    <p id="warning" class="warning"></p>
    
    <hr class="my-4">
    
    <div class="text-center">
      <p class="text-muted small mb-2">¿No tienes una cuenta?</p>
      <a th:href="@{/crearcuenta}" href="/crearcuenta" class="btn btn-outline-primary w-100">
        <i class="bi bi-person-plus me-2"></i>Crear cuenta nueva
      </a>
    </div>
  </form>
  
</main>

<!--FOOTER-->
<footer class="bg-primary text-center text-lg-start mt-auto">
  <div class="container-fluid text-center p-3">
    <span class="text-white">© 2025 PocketBook</span>
  </div>
  <div class="text-center">
      <h6 class="text-white">Todos los derechos reservados</h6>
  </div>
</footer>

<!-- SCRIPTS -->
<div th:replace="~{fragments/scripts :: scripts}"></div>
<script th:src="@{/js/login/login.js}" src="/js/login/login.js"></script>
</body>
</html>