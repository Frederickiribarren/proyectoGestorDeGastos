<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head}">
    <title>Cambiar Contraseña - PocketBook</title>
</head>
<body class="d-flex flex-column min-vh-100">
  <!--CSS-->
  <link th:href="@{/css/login/imagencentral.css}" href="/css/login/imagencentral.css" rel="stylesheet">
  <link th:href="@{/css/login/form.css}" href="/css/login/form.css" rel="stylesheet">
  
  <!--NAVBAR-->
  <nav class="navbar navbar-light bg-primary">
    <div class="container-fluid d-flex justify-content-center align-items-center">
      <a class="navbar-brand d-flex align-items-center gap-2" href="#">
        <img th:src="@{/image/factura.png}" src="/image/factura.png" alt="PocketBook" width="30" height="24" class="d-inline-block align-text-top">
        <span class="text-white">PocketBook</span>
      </a>
    </div>
  </nav>

  <!--FORM-->
  <main class="form-signin d-flex flex-column align-items-center flex-grow-1 image-central">
    
    <!-- MENSAJE DE ERROR -->
    <div th:if="${error}" class="alert alert-danger fade show" role="alert" style="width: 380px; margin-bottom: 1rem;">
      <i class="bi bi-exclamation-triangle-fill me-2"></i>
      <span th:text="${error}"></span>
    </div>

    <form th:action="@{/recuperar-password/cambiar}" method="post" 
          class="border border-dark rounded form-class p-4 shadow" 
          style="width: 380px; background: rgba(255, 255, 255, 0.95);">
      
      <input type="hidden" name="token" th:value="${token}">
      <!-- CSRF token -->
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
      
      <div class="text-center mb-4">
        <i class="bi bi-shield-lock-fill text-primary" style="font-size: 72px;"></i>
        <h1 class="h3 fw-bold">Nueva Contraseña</h1>
        <p class="text-muted small mb-0">Crea una contraseña segura</p>
      </div>

      <!-- NUEVA CONTRASEÑA -->
      <div class="mb-4 position-relative">
        <div style="position: relative;">
          <input type="password" name="nuevaPassword" class="form-control pe-5" id="inputPassword" 
                 minlength="6" style="padding-right: 2.5rem;" placeholder="Nueva contraseña">
          <i class="bi bi-eye-slash" 
             id="togglePassword1" style="cursor: pointer; z-index: 10; position: absolute; right: 1.2rem; top: 50%; transform: translateY(-50%);"></i>
        </div>
        <p class="text-danger small mt-2 mb-0" id="passError"></p>
      </div>

      <!-- CONFIRMAR CONTRASEÑA -->
      <div class="mb-4 position-relative">
        <div style="position: relative;">
          <input type="password" name="confirmarPassword" class="form-control pe-5" id="inputPassword2" 
                 minlength="6" style="padding-right: 2.5rem;" placeholder="Confirmar contraseña">
          <i class="bi bi-eye-slash" 
             id="togglePassword2" style="cursor: pointer; z-index: 10; position: absolute; right: 1.2rem; top: 50%; transform: translateY(-50%);"></i>
        </div>
        <p class="text-danger small mt-2 mb-0" id="confirmPassError"></p>
      </div>

      <button class="w-100 btn btn-lg btn-primary mb-3 fw-semibold" type="submit">
        <i class="bi bi-check-circle me-2"></i>Cambiar contraseña
      </button>
    </form>
  </main>

  <!--FOOTER-->
  <footer class="bg-primary text-center text-lg-start mt-auto">
    <div class="container-fluid text-center p-3">
      <span class="text-white">© 2025 PocketBook</span>
    </div>
    <div class="text-center">
      <h6 class="text-white">Todos los derechos reservados</h6>
    </div>
  </footer>

  <!-- SCRIPTS -->
  <div th:replace="~{fragments/scripts :: scripts}"></div>
  <script th:src="@{/js/forms/cambiar-password.js}" src="/js/forms/cambiar-password.js"></script>
</body>
</html>
