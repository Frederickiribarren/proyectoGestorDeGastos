<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<body>
<!-- SCRIPTS -->
<th:block th:fragment="scripts">
    <!-- BOOTSTRAP JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" 
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" 
            crossorigin="anonymous"></script>
    
    <!-- AUTO-DISMISS ALERTS -->
    <script th:src="@{/js/common/auto-dismiss-alerts.js}" src="/js/common/auto-dismiss-alerts.js"></script>
        <!-- Sidebar active link script -->
        <script>
            (function(){
                function markActiveSidebar() {
                    try {
                        const path = window.location.pathname || '/';
                        const links = document.querySelectorAll('aside#sidebarMenu a.nav-link');
                        links.forEach(a => {
                            try {
                                const href = a.getAttribute('href') || a.getAttribute('th:href');
                                if (!href) return;
                                // Normalize
                                const normalized = href.replace(/^https?:\/\/[^^/]+/, '').split('?')[0];
                                if (path === normalized || path.startsWith(normalized + '/')) {
                                    a.classList.add('active');
                                } else {
                                    a.classList.remove('active');
                                }
                            } catch(e) {}
                        });
                    } catch(e) { console.warn('sidebar active script error', e); }
                }
                if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', markActiveSidebar); else markActiveSidebar();
            })();
        </script>
</th:block>
</body>
</html>
