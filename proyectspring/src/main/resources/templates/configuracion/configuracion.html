<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head :: head}">
    <title>Configuración - PocketBook</title>
</head>
<body>
    <!--CSS-->
    <link rel="stylesheet" th:href="@{/css/common/navbar.css}" href="/css/common/navbar.css">
    <link rel="stylesheet" th:href="@{/css/dashboard/dashboard.css}" href="/css/dashboard/dashboard.css">
    <link rel="stylesheet" th:href="@{/css/configuracion/configuracion.css}" href="/css/configuracion/configuracion.css">
    
    <!-- NAVBAR -->
    <nav th:replace="~{fragments/navbar :: navbar}"></nav>

    <!-- CONTENEDOR PRINCIPAL CON SIDEBAR Y CONTENIDO (igual que dashboard) -->
    <div class="container-fluid">
      <div class="row">
        <!-- SIDEBAR -->
        <aside th:replace="~{fragments/sidebar :: sidebar}"></aside>

        <!-- CONTENIDO PRINCIPAL -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 py-4">
          <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-3 mb-4 border-bottom">
            <div>
              <h1 class="h2 fw-bold mb-1"><i class="bi bi-gear text-primary me-2"></i>Configuración</h1>
              <p class="text-muted mb-0">Ajustes de la aplicación y la seguridad de tu cuenta</p>
            </div>
          </div>

          <div class="row g-4">
            <!-- COLUMNA IZQUIERDA - RESUMEN/INFO -->
            <div class="col-lg-4 mb-4">
                <div class="card border-0 shadow-sm sticky-card">
                    <div class="card-body p-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="bi bi-gear fs-3 text-primary me-3" aria-hidden="true"></i>
                            <div>
                                <h6 class="mb-0">Resumen</h6>
                                <small class="text-muted">Ajustes rápidos y estado</small>
                            </div>
                        </div>
                        <hr>
                        <div class="mb-3">
                            <h6 class="mb-1">Estado</h6>
                            <p class="text-muted small mb-0">2FA: <strong th:text="${tiene2FA} ? 'Activado' : 'Desactivado'">Desactivado</strong></p>
                        </div>
                        <div class="mb-3">
                            <h6 class="mb-1">Notificaciones</h6>
                            <p class="text-muted small mb-0">Recibirás alertas configuradas según tus preferencias</p>
                        </div>
                        <div class="d-grid gap-2 mt-3">
                            <button id="btnRestablecerTodo" class="btn btn-link btn-sm text-decoration-none">Restablecer configuración por defecto</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- COLUMNA DERECHA - TABS CON SECCIONES (Apariencia / Notificaciones / Seguridad) -->
            <div class="col-lg-8">
                <ul class="nav nav-tabs mb-4" id="configTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="apariencia-tab" data-bs-toggle="tab" data-bs-target="#apariencia" type="button" role="tab">
                            <i class="bi bi-palette me-2"></i>Apariencia
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="notificaciones-tab" data-bs-toggle="tab" data-bs-target="#notificaciones" type="button" role="tab">
                            <i class="bi bi-bell me-2"></i>Notificaciones
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="seguridad-tab" data-bs-toggle="tab" data-bs-target="#seguridad" type="button" role="tab">
                            <i class="bi bi-shield-lock me-2"></i>Seguridad
                        </button>
                    </li>
                </ul>

                <div class="tab-content" id="configTabsContent">
                    <!-- Apariencia -->
                    <div class="tab-pane fade show active" id="apariencia" role="tabpanel">
                        <div class="card border-0 shadow-sm mb-4">
                            <div class="card-header bg-white border-0 py-3">
                                <h5 class="mb-0 fw-bold"><i class="bi bi-palette text-primary me-2"></i>Apariencia</h5>
                            </div>
                            <div class="card-body p-4">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="language" class="form-label fw-semibold">Idioma</label>
                                        <select id="language" class="form-select form-select-sm">
                                            <option value="es">Español</option>
                                            <option value="en">English</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="currency" class="form-label fw-semibold">Moneda</label>
                                        <select id="currency" class="form-select form-select-sm">
                                            <option value="CLP">CLP</option>
                                            <option value="USD">USD</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mt-4 d-flex gap-2">
                                    <button id="btnGuardarApariencia" class="btn btn-primary btn-sm"><i class="bi bi-save me-1"></i> Guardar</button>
                                    <button id="btnResetApariencia" class="btn btn-outline-secondary btn-sm" type="button"><i class="bi bi-arrow-counterclockwise me-1"></i> Restablecer</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notificaciones -->
                    <div class="tab-pane fade" id="notificaciones" role="tabpanel">
                        <div class="card border-0 shadow-sm mb-4">
                            <div class="card-header bg-white border-0 py-3">
                                <h5 class="mb-0 fw-bold"><i class="bi bi-bell text-success me-2"></i>Notificaciones</h5>
                            </div>
                            <div class="card-body p-4">
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="notif-email">
                                    <label class="form-check-label" for="notif-email">Notificaciones por email</label>
                                </div>
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="notif-transacciones">
                                    <label class="form-check-label" for="notif-transacciones">Alertas por transacciones</label>
                                </div>
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="notif-presupuesto">
                                    <label class="form-check-label" for="notif-presupuesto">Alertas de presupuesto</label>
                                </div>
                                <div class="form-check form-switch mb-2">
                                    <input class="form-check-input" type="checkbox" id="notif-reportes">
                                    <label class="form-check-label" for="notif-reportes">Reportes mensuales</label>
                                </div>
                                <div class="form-check form-switch mb-3">
                                    <input class="form-check-input" type="checkbox" id="notif-promociones">
                                    <label class="form-check-label" for="notif-promociones">Promociones y ofertas</label>
                                </div>
                                <div class="d-flex gap-2">
                                    <button id="btnGuardarNotificaciones" class="btn btn-success btn-sm"><i class="bi bi-save me-1"></i> Guardar</button>
                                    <button id="btnResetNotificaciones" class="btn btn-outline-secondary btn-sm" type="button"><i class="bi bi-arrow-counterclockwise me-1"></i> Restablecer</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Seguridad -->
                    <div class="tab-pane fade" id="seguridad" role="tabpanel">
                        <div class="card border-0 shadow-sm mb-4">
                            <div class="card-header bg-white border-0 py-3">
                                <h5 class="mb-0 fw-bold"><i class="bi bi-shield-lock text-warning me-2"></i>Seguridad y Datos</h5>
                            </div>
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div>
                                        <h6 class="mb-0">Autenticación de Dos Factores (2FA)</h6>
                                        <small class="text-muted">Activa 2FA para mayor seguridad</small>
                                    </div>
                                    <div>
                                        <button id="btn2FA" class="btn btn-outline-secondary btn-sm">
                                            <i class="bi bi-toggle-off"></i> <span>Desactivado</span>
                                        </button>
                                    </div>
                                </div>
                                <hr>
                                <div class="mb-3">
                                    <button id="btnArchivarDatos" class="btn btn-outline-secondary btn-sm"><i class="bi bi-archive me-1"></i> Archivar datos antiguos</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- incluir script de comportamiento -->
    <script th:src="@{/js/configuracion/configuracion.js}" src="/js/configuracion/configuracion.js"></script>

    <!-- Toast container -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1080">
      <div id="configToastContainer"></div>
    </div>

    <div th:replace="~{fragments/scripts :: scripts}"></div>
</body>
</html>
